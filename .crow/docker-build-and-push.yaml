when:
  - event: push
    branch: main
    path:
      exclude: ['README.md']
  - event: manual

steps:
  - name: build-and-push
    image: woodpeckerci/plugin-docker-buildx
    settings:
      repo: ryuupendragon/icons,ghcr.io/ryuupendragon/icons
      dockerfile: Dockerfile
      platforms: linux/amd64,linux/arm64/v8,linux/arm/v7
      tag: 2.1.0,latest
      logins:
        - registry: https://index.docker.io/v1/
          username: ryuupendragon
          password:
            from_secret: DOCKERHUB_TOKEN
        - registry: https://ghcr.io
          username: ryuupendragon
          password:
            from_secret: GH_TOKEN
